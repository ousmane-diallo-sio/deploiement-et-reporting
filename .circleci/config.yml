# .circleci/config.yml

# CircleCI configuration version
version: 2.1

# Define a job named "build-and-test"
jobs:
  build-and-test:
    # Use macOS environment with Xcode 14.0.1
    macos:
      xcode: 14.0.1
    # Define environment variables for the job
    environment:
      # Set the value of FL_OUTPUT_DIR to "output"
      FL_OUTPUT_DIR: output
      # Set the value of FASTLANE_LANE to "test"
      FASTLANE_LANE: test
    # List of steps to be executed as part of this job
    steps:
      # Check out the code from version control
      - checkout
      # Install project dependencies using Bundler
      - run: bundle install
      # Build and run unit tests using Fastlane
      - run:
          name: Build and run tests
          command: bundle exec fastlane unit_test
      # Store artifacts generated by the job (in this case, output directory)
      - store_artifacts:
          path: output
      # Store test results generated by the job (in this case, scan directory)
      - store_test_results:
          path: output/scan

# Define a workflow named "simple-workflow" that includes the "build-and-test" job
workflows:
  simple-workflow:
    jobs:
      - build-and-test

